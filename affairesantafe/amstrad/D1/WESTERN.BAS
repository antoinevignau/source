1 POKE &BDEE,&C9
2 GOSUB 10000
1000 '-------------------------------INITIALISATION
1010 POKE &BE78,1:ON ERROR GOTO 2510:ON BREAK GOSUB 3240
1040 BORDER 26:INK 1,0:INK 0,26:INK 2,11:INK 3,15:MODE 1
1060 LOAD"!western2.bin",&A000:'-----------------------ROUTINE DE DECOMPACTAGE
1061 LOAD"!erbas.bin",&A300:CALL &A300' 
1065 '-----------------------------------------------------DEMARRAGE
1070 DIM MOT$(200),mot(200):INTER=0:FINMUS=&47C6:FININT=&47D6:INITMUS=&4000:JOUMUS=&4770:VOLAUGT=&47E4
1076 RESTORE 3140:FOR T=1 TO 52:READ MOT$(T):NEXT:WINDOW 5,36,19,25:PEN 0:PAPER 1:CLS:BORDER 26:WINDOW 6,35,20,22:PLOT 68,4,0:DRAWR 0,102:DRAWR 502,0:DRAWR 0,-102:DRAWR-502,0:PLOT 68,40:DRAWR 502,0:WINDOW#1,6,35,24,24:PEN#1,3:PAPER#1,1:CLS#1
1081 LOCATE 1,2:PRINT" PRET POUR L'AVENTURE ..... A";:PRINT#1," REPRISE DE LA PARTIE ..... R";
1082 A$=UPPER$(INKEY$):IF A$=""THEN 1082
1083 IF A$="A"THEN CLS#1:CHA$="RENO":GOTO 2010
1084 IF A$="R"THEN CLS:GOTO 8010 ELSE 1082
2010 CHA$=UPPER$(CHA$):RESTORE 2015:FOR I=1 TO 12:READ NAME$,MUS$:IF CHA$=NAME$THEN I=12
2012 NEXT:IF INTER<>0 THEN CALL FINMUS
2013 POKE &BE78,1:ON ERROR GOTO 2510:LOAD"!"+MUS$+".BIN",&4000:CHAIN MERGE"!"+CHA$+".BAS",10000
2015 DATA 

GOLD,MUS,
TRAPPEUR,MUS9,
JUGEMENT,MUS13,
DESERT,MUS10,
MONTAGNE,MUS14,
RENO,MUS4,
SHERIF,MUS6,
CHASSEUR,MUS16,
VILLAGE,MUS15,
PUEBLO,MUS16,
INDIEN,MUS,
CABANE,MUS2

2500 '----------------------------------------------------MESSAGES ERREURS
2510 '
2530 msg2$="ET APPUYEZ SUR UNE TOUCHE":msg1$="REMETTRE LA DISQUETTE EN PLACE"
2531 IF PEEK(&A445+10)=&64 THEN locx=2:locy=2:msg1$="REMETTRE LA DISQUETTE EN PLACE":CLS
2532 IF PEEK(&A445+14)=&6E THEN locx=3:locy=2:msg1$="RETOURNEZ LA DISQUETTE JEU":CLS
2533 IF PEEK(&A445+10)=&6E THEN locx=5:locy=2:msg1$="INSEREZ LA DISQUETTE":CLS
2538 LOCATE locx,locy:PRINT msg1$:LOCATE 3,3:PRINT"ET APPUYEZ SUR UNE TOUCHE";:CALL &BB18:RESUME
3000 '----------------------------------------------------AFFICHAGE IMAGE
3010 POKE &A00D,AD-INT(AD/256)*256:POKE &A00E,INT(AD/256):CALL &A00C:RETURN
3020 '----------------------------------------------------EDITEUR AUTRES ORDRES
3030 CLS#1:LOCATE#1,4,1:PRINT#1,">";SPC(22);"<";:n$="":x1=5
3040 IF INKEY$=""THEN 3050 ELSE 3040
3050 LOCATE#1,X1,1:PRINT#1,CHR$(143);
3060 A$=UPPER$(INKEY$):IF A$=""THEN 3060
3070 'SOUND 1,100,3,7 
3080 IF A$=CHR$(13)THEN LOCATE#1,X1,1:PRINT#1,CHR$(128);:CLS#1:GOTO 3180
3090 IF a$=CHR$(127)AND x1>5 THEN LOCATE#1,x1,1:PRINT#1,CHR$(128);:x1=x1-1:LOCATE#1,x1,1:PRINT#1,CHR$(143);:n$=LEFT$(n$,LEN(n$)-1):GOTO 3060
3100 IF ASC(a$)=32 OR ASC(a$)=39 THEN 3120
3110 IF(ASC(a$)<48 OR ASC(a$)>90)OR(ASC(a$)>57 AND ASC(a$)<65)THEN 3060
3120 n$=n$+A$:LOCATE#1,x1,1:PRINT#1,A$;:X1=X1+1:IF LEN(n$)=22 THEN 3180 ELSE 3050
3130 '---------------------------------------------------DATAS
3140 DATA "REMPLI","REND","LEV","RABAT","INCLIN","CHAPEAU","STETSON","BAIS","VIOL","","","","FUI","","","","","","","","","","","","","","","LAISS"
3150 DATA "CAPTUR","MAIN","BRAS","","GOURDE","","","","","","",""
3160 DATA "MERD","CACA","SALOP","ENFOIR","CON","CUL","BRANL","PUT","PD","ENCUL","PISSE","LARVE"
3165 GOTO 3030
3170 '---------------------------------------------------ANALYSE SYNTHAXIQUE
3180 RESTORE 3140
3190 FOR t=1 TO 52:READ mot$
3200 IF INSTR(n$,mot$)>0 THEN mot(T)=1 ELSE mot(T)=0
3210 NEXT T
3220 FOR T=41 TO 52:IF MOT(T)=1 THEN CLS#1:LOCATE#1,5,1:PRINT#1,"Grossier personnage ...";:CALL &BB18:FOR te=1 TO 52:mot(te)=0:NEXT te:GOTO 3030
3230 NEXT t
3240 RETURN
4000 '--------------------------------------------------AFFICHAGE COMMENTAIRE
4010 READ COM$:CLS:FOR d=1 TO LEN(com$):PRINT CHR$(ASC(MID$(com$,d,1))+128);:NEXT:RETURN
5000 '--------------------------------------------------LECTURE DES ORDRES
5010 FOR T=1 TO PO:READ ORDRE$(T):NEXT
5020 '--------------------------------------------------AFFICHAGE DES ORDRES
5030 T=1
5040 CLS#1:LONGUEUR=LEN(ORDRE$(T)):DIFF=INT((30-LONGUEUR)/2)
5041 FOR d=1 TO longueur:LOCATE#1,diff+d,1:PRINT#1,CHR$(ASC(MID$(ordre$(t),d,1))+128);:NEXT
5050 A$=UPPER$(INKEY$):IF A$=""THEN 5050
5060 IF A$=CHR$(13)THEN CLS#1:RETURN
5070 IF A$=CHR$(241)THEN T=T+1:IF T>PO THEN T=1
5080 IF A$=CHR$(240)THEN T=T-1:IF T<1 THEN T=PO
5081 IF a$="S"THEN GOTO 7010
5090 GOTO 5040
5100 '---------------------------------------------------S/PROG BRUITAGE
5110 'COUP DE FEU
5120 'FOR T=1 TO 8:SOUND 1,0,20-((8-T)/2),17-(T*2),0,0,15-(T-8)+1:NEXT:RETURN
5124 CALL FININT
5125 ENV 1,1,16,1,15,-1,4
5126 SOUND 1,0,150,15,1,0,24:SOUND 2,0,150,15,1,0,30:FOR coup=0 TO 500:NEXT:CALL &BCA7:CALL JOUMUS:CALL VOLAUGT
5127 RETURN
7000 '------------------------------------------------------SAUVEGARDE
7010 WINDOW 6,35,24,24:CLS:PRINT"SAUVEGARDE DE LA PARTIE  (O/N)";
7020 A$=UPPER$(INKEY$):IF A$=""THEN 7020
7030 IF A$="O"THEN 7040
7031 IF A$="N"THEN 7060 ELSE 7020
7035 'PRINT"ERREUR DE DISQUETTE A REMEDIER";:CALL &BB18:CLS:RESUME
7040 PRINT" METTRE DISQUETTE  SAUVEGARDE";:CALL &BB18:CLS
7050 POKE &BE78,1:ON ERROR GOTO 2510:GOSUB 8060:WINDOW 6,35,20,22:OPENOUT"!PARTIE":WRITE#9,CHA$,ARGENT,MAGGY,NB,JUGEMENT:CLOSEOUT:GOSUB 8070:GOTO 5040
7060 WINDOW 6,35,20,22:GOTO 5040
8000 '------------------------------------------------------RECHARGER
8010 WINDOW 6,35,24,24:CLS:PRINT"REPRISE PARTIE EN COURS  (O/N)";
8020 A$=UPPER$(INKEY$):IF A$=""THEN 8020
8030 IF A$="O"THEN 8040
8031 IF A$="N"THEN 1076 ELSE 8020
8035 'PRINT"ERREUR DE DISQUETTE A REMEDIER";:CALL &BB18:CLS:RESUME
8040 PRINT" METTRE DISQUETTE  SAUVEGARDE";:CALL &BB18:CLS
8050 POKE &BE78,1:ON ERROR GOTO 2510:GOSUB 8060:WINDOW 6,35,20,22:OPENIN"!PARTIE":INPUT#9,CHA$,ARGENT,MAGGY,NB,JUGEMENT:CLOSEIN:GOSUB 8070:GOTO 2010
8060 IF INTER<>0 THEN CALL FINMUS
8065 RETURN
8070 IF INTER<>0 THEN CALL JOUMUS:CALL VOLAUGT
8075 RETURN
8999 '-----------------------------------------------------chance
9000 a$=INKEY$:chance=chance+1:IF chance=2 THEN chance=0
9010 IF a$=""THEN 9000 ELSE RETURN
9100 '-----------------------------------------------------temporisation
9110 FOR te=1 TO temp:NEXT:RETURN
10000 SYMBOL AFTER 225:SYMBOL 225,&X1000,&X11100,&X10100,&X111110,&X100010,&X1110111,&X1110111:SYMBOL 226,&X1111110,&X1111111,&X100001,&X111110,&X100001,&X1111111,&X1111110:SYMBOL 227,&X111110,&X1111111,&X1000001,&X1000000,&X1000001,&X1111111,&X11111
10010 SYMBOL 228,&X1111110,&X1111111,&X100001,&X100001,&X100001,&X1111111,&X1111110:SYMBOL 229,&X1111111,&X1111111,&X100001,&X111000,&X100001,&X1111111,&X1111111:SYMBOL 230,&X1111111,&X1111111,&X100001,&X111000,&X100000,&X1110000,&X1110000
10020 SYMBOL 231,&X111110,&X1111111,&X1000001,&X1000000,&X1000001,&X1111111,&X111101:SYMBOL 232,&X1110111,&X1110111,&X100010,&X111110,&X100010,&X1110111,&X1110111:SYMBOL 233,&X1111111,&X1111111,&X1000,&X1000,&X1000,&X1111111,&X1111111
10030 SYMBOL 234,&X111,&X111,&X10,&X10,&X1000010,&X1111110,&X111100:SYMBOL 235,&X1110011,&X1110011,&X100110,&X111000,&X100110,&X1110011,&X1110011:SYMBOL 236,&X1110000,&X1110000,&X100000,&X100000,&X100001,&X1111111,&X1111111
10040 SYMBOL 237,&X1110111,&X1110111,&X110110,&X101010,&X100010,&X1110111,&X1110111:SYMBOL 238,&X1110111,&X1110111,&X110010,&X101010,&X100110,&X1110111,&X1110111:SYMBOL 239,&X111110,&X1111111,&X1000001,&X1000001,&X1000001,&X1111111,&X111110
10050 SYMBOL 240,&X1111110,&X1111111,&X100001,&X111110,&X100000,&X1110000,&X1110000:SYMBOL 241,&X111110,&X1111111,&X1000001,&X1000101,&X1000010,&X1111111,&X111101:SYMBOL 242,&X1111110,&X1111111,&X100001,&X111110,&X100010,&X1110111,&X1110111
10060 SYMBOL 243,&X111101,&X1111111,&X1100001,&X111100,&X1000011,&X1111111,&X1011110:SYMBOL 244,&X1111111,&X1111111,&X1001001,&X1000,&X1000,&X11100,&X11100:SYMBOL 245,&X1110111,&X1110111,&X100010,&X100010,&X100010,&X111111,&X11111
10070 SYMBOL 246,&X1110111,&X1110111,&X100010,&X100010,&X10100,&X11100,&X11100:SYMBOL 247,&X1110111,&X1110111,&X100010,&X101010,&X101010,&X111110,&X10100:SYMBOL 248,&X1110111,&X1110111,&X100010,&X11100,&X100010,&X1110111,&X1110111
10080 SYMBOL 249,&X1110111,&X1110111,&X100010,&X11100,&X1000,&X11100,&X11100:SYMBOL 250,&X1111111,&X1111110,&X1000100,&X1000,&X10001,&X111111,&X1111111:SYMBOL 251,&X0,&X0,&X0,&X0,&X0,&X1100,&X1100,&X11000:SYMBOL 252,&X1100,&X1100,&X11000
10090 SYMBOL 253,&X0,&X0,&X0,&X11100,&X11100:SYMBOL 254,&X0:MEMORY &3FFF:DEF FNmsb(a)=&FF AND INT(a/256):DEF FNlsb(a)=&FF AND UNT(a):longueur=38:xval1=3:xval2=4:xval3=9:xval4=10:xval5=18:xval6=19:vecteur=&BC80:indir1=39:indir2=41:RESTORE 10150:GOSUB 10110
10100 longueur=37:xval1=4:xval2=5:xval3=10:xval4=11:xval5=28:xval6=29:vecteur=&BC77:indir1=longueur+1:indir2=longueur+2:RESTORE 10140
10110 MEMORY HIMEM-(longueur+3):FOR i=HIMEM+1 TO HIMEM+longueur:READ byte:POKE i,byte:NEXT i
10120 POKE HIMEM+xval1,FNlsb(HIMEM+indir1):POKE HIMEM+xval2,FNmsb(HIMEM+indir1):POKE HIMEM+xval3,FNlsb(HIMEM+indir2):POKE HIMEM+xval4,FNmsb(HIMEM+indir2):POKE HIMEM+xval5,FNlsb(HIMEM+1):POKE HIMEM+xval6,FNmsb(HIMEM+1)
10130 POKE HIMEM+longueur+1,PEEK(vecteur+0):POKE HIMEM+longueur+2,PEEK(vecteur+1):POKE HIMEM+longueur+3,PEEK(vecteur+2):POKE vecteur+0,&C3:POKE vecteur+1,FNlsb(HIMEM+1):POKE vecteur+2,FNmsb(HIMEM+1):RETURN
10140 DATA &e5,&f5,&3a,&0,&0,&32,&77,&bc,&2a,&0,&0,&22,&78,&bc,&f1,&e1,&cd,&77,&bc,&f5,&e5,&3e,&c3,&32,&77,&bc,&21,&0,&0,&22,&78,&bc,&e1,&f1,&cb,&87,&c9
10150 DATA &e5,&2a,&0,&0,&22,&80,&bc,&3a,&0,&0,&32,&82,&bc,&cd,&80,&bc,&21,&0,&0,&22,&81,&bc,&21,&80,&bc,&36,&c3,&e1,&d8,&c8,&fe,&1a,&37,&3f,&c0,&b7,&37,&c9
Ready
